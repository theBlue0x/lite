<!DOCTYPE html>
<html lang='en'>
<head>
	<meta class="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="description" content="Blue0x Lite Wallet">
  <link rel="shortcut icon" href="images/favicon.ico">
  <title>Blue0x | LITE</title>
	<link rel='stylesheet' href='css/style.min.css' />
<script>
  function login() {
    var Account = document.getElementById('user_entered_account_number').value;
    if (!Account) { 
      document.getElementById("user_entered_account_numberErrorMessage").innerHTML = "<p>Account Number Required</p>";
    } else {
      var currentRSAccountNumber =$('#user_entered_account_number').val();
      $.post(Constants.apiUrl, {
        requestType: 'getAccount',
        account: $('#user_entered_account_number').val(),
        includeEffectiveBalance: "true"
      },
      function(result) {
          if (result.errorDescription == 'Unknown account') { // If this is not a valid account number
            document.getElementById("user_entered_account_numberErrorMessage").innerHTML = "<p class=\"validation_message\">New or invalid BLX account.  New BLX accounts must first make an outgoing transaction from the Blue0x wallet.</p>";
            } else {
            var balance = result.balanceNQT / 100000000;
            sessionStorage.setItem("accountRS", result.accountRS);
            sessionStorage.setItem("accountBalance", balance);
            var replace_loginResult = '';
            replace_loginResult += '<div class="auth_auth">';
            replace_loginResult += '<h3>You are logged in with the following account</h3>';
            replace_loginResult += '</br>';
            replace_loginResult += '<h4>Account ID</h4>';
            replace_loginResult += '<p>' + result.accountRS + '</p>';
            replace_loginResult += '</div>';
            replace_loginResult += '<div class="container">';
            replace_loginResult += '<h4>BLX Balance</h4>';
            replace_loginResult += '<p>' + balance + ' BLX </p>';
            replace_loginResult += '</div>';
            document.getElementById("loginResult").innerHTML = replace_loginResult;
          }}, "json");
      $.post(Constants.apiUrl, {
        requestType: 'getAccountCurrencies',
        account: currentRSAccountNumber,
        currency: Constants.USDXId
      },
      function(coinoquery) {
        if (coinoquery.length == 0) {
            var replace_USDXAccountBalance = '';
            replace_USDXAccountBalance += '<div class="container">';
            replace_USDXAccountBalance += '<h4>USDX Balance</h4>';
            replace_USDXAccountBalance += '<p>0 USDX</p>';
            replace_USDXAccountBalance += '</div>';
            replace_USDXAccountBalance += '</br>';
            replace_USDXAccountBalance += '<a class="button button__primary" href="currency_select.html" role="button">&nbsp;&ensp;Send&nbsp;&ensp;</a>&nbsp;&nbsp;<a class="button button__primary" href="receive.html" role="button">Receive</a>';
            document.getElementById("USDXAccountBalance").innerHTML = replace_USDXAccountBalance;
          } else {
            var USDXAccountBalance = coinoquery.units;
            sessionStorage.setItem("USDXAccountBalance", coinoquery.units);
            var convertedUSDXAccountBalance = USDXAccountBalance / 100;
            var replace_USDXAccountBalance = '';
            replace_USDXAccountBalance += '<div class="container">';
            replace_USDXAccountBalance += '<h4>USDX Balance</h4>';
            replace_USDXAccountBalance += '<p>' + convertedUSDXAccountBalance + ' USDX</p>';
            replace_USDXAccountBalance += '</div>';
            replace_USDXAccountBalance += '</br>';
            replace_USDXAccountBalance += '<a class="button button__primary" href="currency_select.html" role="button">&nbsp;&ensp;Send&nbsp;&ensp;</a>&nbsp;&nbsp;<a class="button button__primary" href="receive.html" role="button">Receive</a>';
            document.getElementById("USDXAccountBalance").innerHTML = replace_USDXAccountBalance;
          }
        }, "json");
    }};
</script>
<style>
@media (max-device-width: 994px) {
  h3 {
   display: none;
  }}
h3 {
    margin-bottom: -5px;
}
h4 {
  font-size: 1em;
  color: cornflowerblue;
  margin: 10px;
  line-height: .5em;
}
</style>
</head>
<body>
	<div class="auth">
		<div class="container">
			<div class="auth__inner">
				<div class="auth__media">
					<img src="./images/access_account.svg">
				</div>
					<div class="auth__auth">
						<div id="loginResult">
						<h1 class="auth__title">Access your account</h1>
						<p>Enter your Blue0x account number below</p>
						<form>
							<input name="account" class="fakefield" type="text" id="user_entered_account_number" placeholder="BLX - _______ - _______ - _______ - _______">
						</form>
						<div id="user_entered_account_numberErrorMessage"></div>
						<button class="button button__primary" type="submit" onclick="login();">Log In</button>
					</div>
					<div id="USDXAccountBalance"></div>
				</div>
			</div>
		</div>
	</div>
	<script src='js/app.min.js'></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/freemarket_scripts.min.js"></script>
	<script src="js/constants.js"></script>
</body>
</html>